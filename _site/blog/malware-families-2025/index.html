<!DOCTYPE html>
<html lang="en"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v9.2.1 <https://hydejack.com/>
-->







<head>
  






  
    
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>What Malware Families Are Still Alive in 2025? | Jonathan Fuller</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="What Malware Families Are Still Alive in 2025?" />
<meta name="author" content="Jonathan Fuller" />
<meta property="og:locale" content="en" />
<meta name="description" content="An empirical look at which malware families persist into 2025." />
<meta property="og:description" content="An empirical look at which malware families persist into 2025." />
<link rel="canonical" href="http://localhost:4000/blog/malware-families-2025/" />
<meta property="og:url" content="http://localhost:4000/blog/malware-families-2025/" />
<meta property="og:site_name" content="Jonathan Fuller" />
<meta property="og:image" content="http://localhost:4000/assets/blogs/yearly_malware/icon.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-31T00:00:00-04:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/blogs/yearly_malware/icon.png" />
<meta property="twitter:title" content="What Malware Families Are Still Alive in 2025?" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jonathan Fuller"},"dateModified":"2025-10-31T15:26:32-04:00","datePublished":"2025-10-31T00:00:00-04:00","description":"An empirical look at which malware families persist into 2025.","headline":"What Malware Families Are Still Alive in 2025?","image":"http://localhost:4000/assets/blogs/yearly_malware/icon.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/malware-families-2025/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logo.jpg"},"name":"Jonathan Fuller"},"url":"http://localhost:4000/blog/malware-families-2025/"}</script>
<!-- End Jekyll SEO tag -->


  

  
    <meta name="keywords" content="Jonathan Fuller,Empirical Defense,cybersecurity leadership,cybersecurity research,digital forensics,cyber education,security and privacy,ciso,professor,malware,reverse engineering,memory forensics,symbolic execution,concolic analysis,security operations,risk management">
  



  <meta name="color-scheme" content="dark light">



  <meta name="theme-color" content="rgb(25,55,71)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Jonathan Fuller">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="Jonathan Fuller">

<meta name="generator" content="Hydejack v9.2.1" />


<link rel="alternate" href="http://localhost:4000/blog/malware-families-2025/" hreflang="en">

<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Jonathan Fuller" />


<link rel="shortcut icon"    href="/assets/icons/icon-128x128.png">
<link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">

<link rel="manifest" href="/assets/site.webmanifest">





<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">


  
  <link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css" id="_katexPreload">
  <noscript><link rel="stylesheet" href="/assets/bower_components/katex/dist/katex.min.css"></noscript>





<script>((r,a)=>{function d(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=a.createElement("script"),e=(n.src=e,t&&d(n,"load",t,{once:!0}),a.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=a.createElement("script");function o(){r._loaded=!0,t&&d(n,"load",t,{once:!0});var e=a.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():d(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){d(a.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}})(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = false;
  w._noToc = false;
  w._noSearch = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2025-10-31T15:26:33-04:00',
  };
  w._clapButton = true;
}(window);</script>



<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.2.1.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">




  <style id="_pageStyle">

html{--accent-color: rgb(79,177,186);--accent-color-faded: rgba(79, 177, 186, 0.5);--accent-color-highlight: rgba(79, 177, 186, 0.1);--accent-color-darkened: #409ba3;--theme-color: rgb(25,55,71);--dark-mode-body-bg: hsl(200.8695652174, 5.9895833333%, 17.5%);--dark-mode-border-color: hsl(200.8695652174, 5.9895833333%, 22.5%)}
</style>


<!--<![endif]-->


<!-- Add HTML tags here to be included in the head. You can delete the below: -->
<link rel="dns-prefetch" href="https://assets.gumroad.com">
<script type="module">
  const loadJS = x => new Promise(r => window.loadJS(x).addEventListener('load', r));

  let p1, p2, io1, io2, embedCreated, overlayCreated;
  document.querySelector('hy-push-state').addEventListener('load', () => {
    io1 ||= new IntersectionObserver(async (entries) => {
      if (entries.some(x => x.isIntersecting)) {
        p1 = p1 || loadJS('https://gumroad.com/js/gumroad-embed.js');
        await p1;
        !embedCreated && await new Promise(function check1(res) {
          if (typeof createGumroadEmbed !== 'undefined')  {
            embedCreated = 1;
            res(createGumroadEmbed());
          }
          else setTimeout(() => check1(res), 200);
        });
        await new Promise(function check2(res) {
          if (typeof GumroadEmbed !== 'undefined') res(GumroadEmbed.reload());
          else setTimeout(() => check2(res), 200);
        });
      }
    }, { rootMargin: '1440px' });

    io2 ||= new IntersectionObserver(async (entries) => {
      if (entries.some(x => x.isIntersecting)) {
        p2 = p2 || loadJS('https://gumroad.com/js/gumroad.js');
        await p2;
        !overlayCreated && await new Promise(function check(res) {
          if (typeof createGumroadOverlay !== 'undefined') {
            overlayCreated = 1;
            res(createGumroadOverlay());
          }
          else setTimeout(() => check(res), 200);
        });
      }
    }, { rootMargin: '300px' });

    document.querySelectorAll('.gumroad-product-embed').forEach(el => io1.observe(el));
    document.querySelectorAll('.gumroad-button').forEach(el => io2.observe(el));
  });
</script>


</head>

<body class="no-break-layout">
  
<script>
  window._sunrise = 6;
  window._sunset =  18;
  ((e,s)=>{var d="light-mode",a="dark-mode",o=(new Date).getHours();"matchMedia"in e&&e.matchMedia("(prefers-color-scheme)")||(e=(o=o<=e._sunrise||o>=e._sunset?a:d)==a?d:a,s.body.classList.add(o),s.body.classList.remove(e))})(window,document);

</script>



<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <button
        id="_nav-search-toggle"
        class="nav-btn no-hover"
        type="button"
        aria-expanded="false"
        aria-controls="_nav-search-panel"
        data-search-toggle
      >
        <span class="sr-only">Search</span>
        <span class="icon-search"></span>
      </button>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<div
  id="_nav-search-panel"
  class="nav-search-panel"
  role="dialog"
  aria-modal="true"
  aria-labelledby="_nav-search-toggle"
  hidden
  data-search-panel
>
  <div class="nav-search-surface">
    <div class="search-pane" data-search-container>
      <div class="nav-search-header">
        <label class="sr-only" for="_nav-search-input">
          Search
        </label>
        <input
          id="_nav-search-input"
          class="search-pane__input nav-search-input"
          type="search"
          placeholder="Type something…"
          autocomplete="off"
          data-search-input
        />
        <button
          type="button"
          class="nav-btn nav-search-close"
          data-search-close
        >
          <span class="sr-only">Close</span>
          <span class="icon-cross"></span>
        </button>
      </div>
      <p class="nav-search-status" data-search-status hidden></p>
      <ul class="search-pane__results nav-search-results" data-search-results role="list"></ul>
      <p class="search-result--empty nav-search-empty" data-search-empty hidden>
        No results found for
        <span data-search-query></span>.
      </p>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-blog"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/">blog</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>malware-families-2025</span>
        
      </li>
    
  
</ul></nav>
  










<article id="post-blog-malware-landscape-2025" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        What Malware Families Are Still Alive in 2025?
      
    </h1>

    



  
    <p class="note-sm" >
      An empirical look at which malware families persist into 2025.

    </p>
  


  </header>

  
    <p>The quarter began with a death knell: <strong>MS-ISAC’s long-running “Top 10 Malware” bulletins went silent</strong> when funding for the program was withdrawn. Those lists once offered defenders a scoreboard. With the scoreboard gone, “top lists” (among other important provisions) became relics…nostalgia for an era when counting families felt like understanding them.</p>

<p>Malware doesn’t vanish when the headlines fade. Even after takedowns, sinkholes, and splashy law-enforcement wins, the same families reappear with new droppers, obfuscation, and recycled infrastructure.</p>

<p>This post takes an <strong>Empirical Defense</strong> view of that persistence. Using <a href="https://www.virustotal.com/">VirusTotal</a> metadata and <a href="https://github.com/malicialab/avclass">AVClass</a> labeling, it measures which families actually survived into 2025, how they evolved, and what that means for defenders who want evidence instead of anecdotes.</p>

<hr />

<h2 id="method-summary">Method Summary</h2>

<ul>
  <li><strong>Data Source:</strong> VirusTotal Intelligence</li>
  <li><strong>Normalization:</strong> AVClass for family labeling across AV engines</li>
  <li><strong>Window:</strong> November 2024 through October 2025 (fiscal year 2025)</li>
  <li><strong>Sampling:</strong> 10,000 samples per month (120,000 total) selected randomly</li>
  <li><strong>Filters:</strong> <code class="language-plaintext highlighter-rouge">p:5+</code> samples flagged by at least five engines</li>
</ul>

<p>We follow <strong>Zhu et al. (USENIX Security 2020)</strong> who show that false positives on VirusTotal drop significantly once a threshold of five or more detections is applied. Their precision–recall analysis supports this cutoff as a practical balance between recall and precision. VirusTotal’s own documentation also suggests using more than five detections to avoid false positives. The <code class="language-plaintext highlighter-rouge">p:5+</code> filter is therefore a conservative but empirically grounded threshold.</p>

<blockquote>
  <p><strong>Disclaimer:</strong> VirusTotal data is not a population sample. It reflects user submissions and scanning bias, not global prevalence. AVClass labels are heuristic and depend on the underlying engine consensus. Results indicate patterns within this dataset, not global infection counts.</p>
</blockquote>

<p>Every chart below is rendered directly from that dataset.</p>

<hr />

<h2 id="top-families-still-circulating">Top Families Still Circulating</h2>

<p><img src="./out/fig_top_families_2025.png" alt="Top families" /></p>

<p><strong>Figure 1.</strong> Top 15 malware families by sample volume in fiscal year 2025.</p>

<p>Ghanarava trojan dominated the sample set with 17,635 hashes (14.7%), followed by Android adware/PUA (10,467 / 8.7%), the “generic ML loader” cluster (10,002 / 8.3%), riskware loaders (9,855 / 8.2%), and Android monitoring tools (5,757 / 4.8%). Mobidash, VMProtect, Wacatac, and the OnlineGames stealers fill out the rest of the top tier.</p>

<p>Legacy families from the old MS-ISAC lists barely register. Emotet appears 73 times, Zeus/Zbot only 63, and Qakbot never clears the five-engine threshold. Mirai contributes 498 mostly recycled binaries.</p>

<p><strong>Why it matters:</strong> four loader families account for over 40% of observed samples. That concentration gives defenders a clear target list for tuning detections and hunts. Focus where the telemetry shows life, not where nostalgia lingers.</p>

<hr />

<h2 id="family-persistence-through-the-year">Family Persistence Through the Year</h2>

<p><img src="./out/fig_family_persistence_2025.png" alt="Family persistence" /></p>

<p><strong>Figure 2.</strong> Monthly activity for major families.</p>

<p>Ghanarava averaged more than 1,600 uploads per month until August, then fell to 67 hashes by October. Riskware loaders and the “generic ML” droppers plateau through mid-year before tapering. Android adware peaked in July–August and nearly disappeared by October.</p>

<p><strong>How it’s measured:</strong> first-seen timestamps are grouped by month and counted by family. Each point represents unique files, not re-uploads.</p>

<p><strong>Why it matters:</strong> persistent upload activity signals live infrastructure. Sudden drops suggest takedown success or campaign retirement.</p>

<p>The pattern is clear: yesterday’s headline families are obituaries. The active ecosystem now revolves around modular loaders, adware clusters, and mobile kits.</p>

<hr />

<h2 id="file-types-and-delivery-mediums">File Types and Delivery Mediums</h2>

<p><img src="./out/fig_family_filekind_heatmap_counts.png" alt="File types" /></p>

<p><strong>Figure 3.</strong> Distribution of delivery file types (PE, archive, script, etc.) by family.</p>

<p>Most samples are still plain executables.</p>
<ul>
  <li><strong>PE files:</strong> 63,867 (53.2%)</li>
  <li><strong>Android/Other:</strong> 37,388 (31.2%)</li>
  <li><strong>Archives:</strong> 15,242 (12.7%)</li>
  <li><strong>Script, Office, ISO, LNK:</strong> ~1% combined</li>
</ul>

<p><strong>Method note:</strong> VirusTotal <code class="language-plaintext highlighter-rouge">type_tag</code>, MIME type, and file extension were normalized into a consistent taxonomy before cross-tabulation.</p>

<p><strong>Why it matters:</strong> focusing sandbox and EDR investment on executable behavior yields higher return than tuning macro defenses for these families. Scripts and Office droppers are now minor carriers compared to compiled loaders.</p>

<hr />

<h2 id="detection-depth-and-file-size">Detection Depth and File Size</h2>

<p><img src="./out/fig_detections_hist.png" alt="Detections histogram" /></p>

<p><strong>Figure 4.</strong> Number of engines flagging each sample.</p>

<p><img src="./out/fig_size_by_family_box.png" alt="Size by family" /></p>

<p><strong>Figure 5.</strong> File size variance (log scale) across families.</p>

<ul>
  <li>73.1% of samples were flagged by ≥10 vendors</li>
  <li>52.8% by ≥20 vendors</li>
  <li>Median detection count: 21</li>
  <li>Mean: 24.8</li>
</ul>

<p>Median file sizes:</p>
<ul>
  <li>Ghanarava – 6.5 MB (IQR 1.3–16.3 MB)</li>
  <li>Riskware loaders – 7.1 MB</li>
  <li>Generic ML loaders – 4.6 MB</li>
  <li>Android adware – 19 MB</li>
</ul>

<p><strong>Interpretation:</strong> high consensus and large payloads indicate well-understood families. If such samples appear in your telemetry with few detections, there may be feed gaps or evasion artifacts worth reviewing.</p>

<hr />

<h2 id="measuring-resurgence">Measuring Resurgence</h2>

<p><img src="./out/fig_resurgence_index.png" alt="Resurgence index" /></p>

<p><strong>Figure 6.</strong> Resurgence Index for legacy families (Jan 2025 = 100%).</p>

<p>The index stayed flat. Classic botnets like Mirai, Zeus, and Qakbot did not regain traction in this dataset. That silence is itself a finding—evidence that their infrastructures remain largely dormant.</p>

<p>For analysts interested in legacy families, rerun the workflow with different filters or larger quotas. Within this slice, the loaders and Android clusters are the operational heart of 2025 malware.</p>

<hr />

<h2 id="delivery-vectors-in-motion">Delivery Vectors in Motion</h2>

<p><img src="./out/fig_delivery_vector_shift.png" alt="Delivery vectors" /></p>

<p><strong>Figure 7.</strong> Monthly share of Office, LNK, ISO, OneNote, and script-based droppers.</p>

<p>Executable loaders dominate every month. PE files maintain 40–70% share through August. Android packages surge only when PE-heavy families taper off in September.</p>

<p>Scripts, Office documents, and ISO droppers remain marginal.</p>

<p><strong>Method note:</strong> monthly family counts were converted to proportional shares per file-kind.</p>

<p><strong>Why it matters:</strong> security teams should prioritize executable delivery controls. Macro defenses alone will not capture where the real activity resides.</p>

<hr />

<h2 id="vendor-consensus">Vendor Consensus</h2>

<p><img src="./out/fig_vendor_consensus.png" alt="Vendor consensus" /></p>

<p><strong>Figure 8.</strong> Average detections per family vs. percentage of samples flagged by ≥10 engines.</p>

<p>Vendor agreement is uneven.</p>
<ul>
  <li><strong>High consensus:</strong> Ghanarava (33 average detections, 96.8% ≥10), Redcap and Wacatac &gt;99%.</li>
  <li><strong>Low consensus:</strong> Android adware/PUA and Mobidash average 9–10 detections; only ~35% clear the ≥10 threshold.</li>
</ul>

<p><strong>Why it matters:</strong> Windows families are saturated with signatures, while grayware and mobile threats remain under-labeled. Use these discrepancies to guide where additional telemetry or vendor diversity improves coverage.</p>

<hr />

<h2 id="mitre-attck-techniques-t-codes">MITRE ATT&amp;CK Techniques (T-Codes)</h2>

<p><img src="./out/fig_attack_top_techniques.png" alt="ATT&amp;CK techniques" /></p>

<p><strong>Figure 9.</strong> Ten most common MITRE ATT&amp;CK techniques by T-code.</p>

<p>Top techniques:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">T1071</code> – Application Layer Protocol (7,711 samples)</li>
  <li><code class="language-plaintext highlighter-rouge">T1082</code> – System Information Discovery (7,242)</li>
  <li><code class="language-plaintext highlighter-rouge">T1574</code> / <code class="language-plaintext highlighter-rouge">.002</code> – Hijack / Side-load (~6.5k each)</li>
  <li><code class="language-plaintext highlighter-rouge">T1497</code> – Virtualization or Sandbox Evasion (6,254)</li>
  <li><code class="language-plaintext highlighter-rouge">T1027</code> – Obfuscated Files (5,945)</li>
  <li><code class="language-plaintext highlighter-rouge">T1055</code> – Process Injection (4,781)</li>
</ul>

<p>These reflect loader behavior: network communication, system profiling, and anti-analysis routines.</p>

<p><strong>Method note:</strong> MITRE technique labels come from sandbox traces and IDS annotations normalized to <code class="language-plaintext highlighter-rouge">T####</code> identifiers.</p>

<p><strong>Why it matters:</strong> these T-codes show which ATT&amp;CK detections deserve highest priority in defensive engineering and hunt logic.</p>

<hr />

<h2 id="edr-bypass-techniques">EDR Bypass Techniques</h2>

<p><img src="./out/fig_edr_bypass_top.png" alt="EDR bypass toplist" /></p>

<p><strong>Figure 10.</strong> Distinct samples showing EDR or defense-evasion behavior.</p>

<p><img src="./out/fig_edr_bypass_trend.png" alt="EDR bypass trend" /></p>

<p><strong>Figure 11.</strong> Monthly cadence of EDR bypass events.</p>

<p>EDR bypass activity is widespread:</p>
<ul>
  <li>Virtualization/sandbox evasion – 6,254 samples</li>
  <li>Process injection – 4,781</li>
  <li>Security-tool disruption – 3,263</li>
  <li>Anti-forensics cleanup – 2,732</li>
</ul>

<p><strong>How it’s measured:</strong> heuristic scanning of sandbox and IDS notes for ATT&amp;CK references (<code class="language-plaintext highlighter-rouge">T1055</code>, <code class="language-plaintext highlighter-rouge">T1562</code>, etc.) and keywords such as “syswhispers” or “unhook”.</p>

<p><strong>Why it matters:</strong> commodity loaders now implement advanced evasion methods. These aren’t APT-only behaviors—they’re mass-market.</p>

<hr />

<h2 id="mitre-attck-tactics-ta-codes">MITRE ATT&amp;CK Tactics (TA-Codes)</h2>

<p><img src="./out/fig_attack_top_tactics.png" alt="ATT&amp;CK tactics" /></p>

<p><strong>Figure 12.</strong> Most prevalent ATT&amp;CK tactics by TA-code.</p>

<p>Leading tactics:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">TA0007</code> – Discovery</li>
  <li><code class="language-plaintext highlighter-rouge">TA0005</code> – Defense Evasion</li>
  <li><code class="language-plaintext highlighter-rouge">TA0011</code> – Command and Control</li>
  <li><code class="language-plaintext highlighter-rouge">TA0004</code> – Privilege Escalation</li>
  <li><code class="language-plaintext highlighter-rouge">TA0002</code> – Execution</li>
</ul>

<p>Credential access (<code class="language-plaintext highlighter-rouge">TA0006</code>) and collection (<code class="language-plaintext highlighter-rouge">TA0009</code>) remain present in over half the samples. These pillars mirror the loader-to-post-compromise transition chain that persists across campaigns.</p>

<hr />

<h2 id="cia-impact-assessment">CIA Impact Assessment</h2>

<p><img src="./out/fig_cia_by_family.png" alt="CIA by family" /></p>

<p><strong>Figure 13.</strong> CIA triad impact distribution for the top families.</p>

<p><img src="./out/fig_cia_trend.png" alt="CIA trend" /></p>

<p><strong>Figure 14.</strong> Monthly mix of confidentiality, integrity, and availability impacts.</p>

<p>Impact scoring maps observed MITRE techniques to CIA outcomes: exfiltration contributes to Confidentiality, tampering to Integrity, and destructive actions to Availability.</p>

<ul>
  <li>113,913 samples had no confirmed behavior (labeled “unknown”).</li>
  <li>6,087 scored measurable impact:
    <ul>
      <li>3,101 confidentiality-weighted</li>
      <li>1,397 mixed (CI/AI/ACI)</li>
      <li>128 availability-only</li>
    </ul>
  </li>
</ul>

<p>Ghanarava dominates the confidentiality profile, while riskware and ML loaders show more integrity or availability effects.</p>

<p><strong>Why it matters:</strong> turning behavioral telemetry into CIA language helps SOCs align defensive priorities with impact rather than family name.</p>

<hr />

<h2 id="targeting-signals-industries-regions-software">Targeting Signals: Industries, Regions, Software</h2>

<p><img src="./out/fig_targeting_industry.png" alt="Targeting industries" /></p>

<p><strong>Figure 15.</strong> Inferred industry targeting signals.</p>

<p><img src="./out/fig_targeting_country.png" alt="Targeting countries" /></p>

<p><strong>Figure 16.</strong> Inferred regional targeting signals.</p>

<p><img src="./out/fig_targeting_software.png" alt="Targeting software" /></p>

<p><strong>Figure 17.</strong> Software and platform references observed.</p>

<p>Weak-supervision rules surfaced targeting hints on 4,598 hashes (~3.8%).</p>
<ul>
  <li><strong>Industries:</strong> 4,529 samples showed “government” lure signals.</li>
  <li><strong>Software:</strong> 484 referenced Microsoft Office.</li>
  <li><strong>Regions:</strong> Germany, United States, India, and the UK cleared the geographic threshold (&lt;100 hashes total).</li>
</ul>

<p><strong>How it’s measured:</strong> label functions extract features from filenames, IDS text, and infrastructure overlaps. Tags are emitted only when two or more independent signals agree.</p>

<p><strong>Why it matters:</strong> this approach provides reproducible, low-confidence targeting leads without overstating attribution. Transparency and repeatability over speculation.</p>

<hr />

<h2 id="why-this-matters-in-2025">Why This Matters in 2025</h2>

<ul>
  <li>Replaces outdated “top 10” lists with measurable telemetry.</li>
  <li>Quantifies which families survive beyond headlines.</li>
  <li>Shows how loaders now dominate the ecosystem.</li>
  <li>Clarifies detection gaps across vendors and platforms.</li>
  <li>Links behaviors directly to ATT&amp;CK and CIA impact categories.</li>
</ul>

<p><strong>Empirical Defense</strong> means building strategy on observable data, not anecdote. This analysis grounds malware discussion in repeatable measurement—the same way epidemiology tracks infection, mutation, and recurrence.</p>

<hr />

<h2 id="key-findings">Key Findings</h2>

<ul>
  <li><strong>Top Families:</strong> Ghanarava (14.7%), Android adware (8.7%), ML loaders (8.3%), riskware loaders (8.2%), Android monitors (4.8%).</li>
  <li><strong>Decline:</strong> Ghanarava fell from 1,741 uploads in November to 67 in October.</li>
  <li><strong>Delivery:</strong> PE executables dominated (53%), Android archives close behind.</li>
  <li><strong>Detection:</strong> 73.1% flagged by ≥10 vendors; median 21 detections.</li>
  <li><strong>ATT&amp;CK:</strong> Techniques <code class="language-plaintext highlighter-rouge">T1071</code>, <code class="language-plaintext highlighter-rouge">T1082</code>, <code class="language-plaintext highlighter-rouge">T1574</code>, <code class="language-plaintext highlighter-rouge">T1497</code>, <code class="language-plaintext highlighter-rouge">T1055</code> led activity.</li>
  <li><strong>CIA:</strong> 6k scored samples, mostly confidentiality-weighted.</li>
  <li><strong>Targeting:</strong> 3.8% of hashes carried medium-confidence signals, mainly government-themed.</li>
</ul>

<hr />

<h2 id="reproducibility-notes">Reproducibility Notes</h2>

<p>All figures are reproducible with the provided dataset and configuration files.<br />
Analysts can rerun the pipeline with different months, filters, or quotas to extend the results.</p>

<blockquote>
  <p><strong>VirusTotal disclaimer:</strong> Data reflects what users upload and scan, not what infects systems globally.<br />
<strong>AVClass2 disclaimer:</strong> Family labels are heuristic and depend on AV naming consensus.<br />
<strong>Heuristic disclaimer:</strong> Inference rules for targeting and behavior rely on pattern matching, not manual validation.</p>
</blockquote>

<hr />

<p><strong>The scoreboard is gone, but the data remains.</strong><br />
Empirical Defense is the way forward: measure, verify, and adjust.</p>

  
</article>



  <hr class="dingbat related mb6" />






  
     


  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img
  
    src="/assets/img/headshot.png"
    srcset="/assets/img/headshot.png 1x,/assets/img/headshot.png 2x"
    
  
  alt="Jonathan Fuller"
  class="avatar"
  
  width="120"
  height="120"
  loading="lazy"
/>

  

  
  
  <h2  class="page-title hr-bottom">
    About
  </h2>

  <p>Jonathan Fuller serves as the Chief Information Security Officer and an Assistant Professor at the United States Military Academy at West Point, where he leads enterprise cybersecurity strategy and governance in a mission-critical environment.</p>

<p>He holds a Ph.D. in Electrical and Computer Engineering with a focus on cybersecurity and brings nearly two decades of Army experience in secure communications, cyber operations, and organizational leadership. His professional and academic work inform <button type="button" class="definition-trigger" data-definition-target="definition-empiricaldefense">Empirical Defense</button>, a platform dedicated to advancing cybersecurity through research, education, and evidence-based practice.</p>


  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.linkedin.com/in/fullsec" title="LinkedIn" class="no-mark-external">
      <span class="icon-linkedin2"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>


  

  
  

  
    


  

  
  

  
    

  


  
<footer class="content" role="contentinfo">
  <hr/>
  
    <p><small class="copyright">© 2025. All rights reserved.
</small></p>
  
  
    <nav class="legal"><small>
    
      
      <a class="heading flip-title" href="/privacy/">Privacy Policy</a>
      |
    
      
      <a class="heading flip-title" href="/cookies/">Cookie Policy</a>
      
    
    </small></nav>
  
    <p><small>Powered by <a class="external" href="https://hydejack.com/">Hydejack</a> v<span id="_version">9.2.1</span></small></p>
  <hr class="sr-only"/>
</footer>


</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg sidebar-overlay" style="background-color:rgb(25,55,71);background-image:url(/assets/img/sidebar/ed.jpg)"></div>

    <div class="sidebar-sticky">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="/assets/img/logo.jpg" class="avatar" alt="Jonathan Fuller" width="120" height="120" loading="lazy" />
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h1">Jonathan Fuller</h2></a>
    
    
      <p class="">
        Bridging Research, Education, and Cyber Defense

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/blog/"
          class="sidebar-nav-item "
          
        >
          Blog
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/publications/"
          class="sidebar-nav-item "
          
        >
          Publications
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/talks/"
          class="sidebar-nav-item "
          
        >
          Talks
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/teaching/"
          class="sidebar-nav-item "
          
        >
          Teaching
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.linkedin.com/in/fullsec" title="LinkedIn" class="no-mark-external">
      <span class="icon-linkedin2"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>(()=>{var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())})();
</script>
  <script src="/assets/js/hydejack-9.2.1.js" type="module"></script>
  <script src="/assets/js/LEGACY-hydejack-9.2.1.js" nomodule defer></script>
  

  

<!--<![endif]-->
  <!--
Code for integrating CloudFlare's email protection with Hydejack's single page app loading.
-->
<script>
  document.getElementById('_pushState').addEventListener('hy-push-state-after', function (e) {
    function e(e){
      (console.error?console.error:console.log).call(console,e)
    }

    function t(e){
      return l.innerHTML='<a href="'+e.replace(/"/g,"&quot;")+'"></a>',l.childNodes[0].getAttribute("href")
    }

    function r(e,t){
      var r=e.substr(t,2);return parseInt(r,16)
    }

    function n(e,n){
      for(var o="",c=r(e,n),a=n+2;a<e.length;a+=2){
        var l=r(e,a)^c;
        o+=String.fromCharCode(l)
      }
      return t(o)
    }

    var o="/cdn-cgi/l/email-protection#",
        c=".__cf_email__",
        a="data-cfemail",
        l=document.createElement("div");

    !function(){
      for(var t=document.getElementsByTagName("a"),r=0;r<t.length;r++)
        try{
          var c=t[r],a=c.href.indexOf(o);
          a>-1&&(c.href="mailto:"+n(c.href,a+o.length))
        }catch(t){
          e(t)
        }
    }(),
    function(){
      for(var t=document.querySelectorAll(c),r=0;r<t.length;r++)
        try{
          var o=t[r],l=n(o.getAttribute(a),0),i=document.createTextNode(l);
          o.parentNode.replaceChild(i,o)
        }catch(t){
          e(t)
        }
    }()
  });
</script>








<div id="definition-empiricaldefense"
     class="definition-modal"
     hidden
     role="dialog"
     aria-modal="true"
     aria-labelledby="definition-title-empiricaldefense">
  <div class="definition-modal__panel">
    <button type="button"
            class="definition-modal__close"
            aria-label="Close Empirical Defense definition">×</button>
    <h2 id="definition-title-empiricaldefense">Empirical Defense</h2>
    <p><strong>Empirical Defense</strong> represents the philosophy that cybersecurity should be practiced as an evolving discipline, guided by evidence, grounded in research, and strengthened through shared knowledge.</p>

<p>The platform explores how <strong>analysis</strong>, <strong>experimentation</strong>, and <strong>education</strong> intersect to advance the understanding and practice of cyber defense. Through this lens, Empirical Defense promotes data-informed approaches to problem-solving, resilience, and innovation in the face of evolving digital threats. It serves as a space for advancing discussion, sharing insight, and connecting rigorous research with real-world application.</p>

<ul>
  <li><strong>Research:</strong> Apply analytical rigor to uncover patterns, validate ideas, and advance the science of cyber defense.</li>
  <li><strong>Education:</strong> Translate knowledge into practice to elevate understanding and capability across the cybersecurity community.</li>
  <li><strong>Practice:</strong> Apply insights, experimentation, and reflection to refine methods and strengthen defensive capability.</li>
</ul>

<p><strong>Mission:</strong> Empirical Defense advances a future where cybersecurity is driven by analysis, guided by evidence, and sustained through continual learning.</p>

  </div>
</div>

<script>
(function() {
  function closeModal(modal) {
    modal.setAttribute('hidden', '');
  }

  document.addEventListener('click', function(event) {
    var trigger = event.target.closest('.definition-trigger');
    if (trigger) {
      var targetId = trigger.getAttribute('data-definition-target');
      if (!targetId) return;
      var modal = document.getElementById(targetId);
      if (modal) {
        modal.removeAttribute('hidden');
        var closeBtn = modal.querySelector('.definition-modal__close');
        if (closeBtn) {
          closeBtn.focus();
        }
      }
      return;
    }

    var closeBtn = event.target.closest('.definition-modal__close');
    if (closeBtn) {
      closeModal(closeBtn.closest('.definition-modal'));
      return;
    }

    if (event.target.classList.contains('definition-modal')) {
      closeModal(event.target);
    }
  });

  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      document.querySelectorAll('.definition-modal').forEach(function(modal) {
        if (!modal.hasAttribute('hidden')) {
          closeModal(modal);
        }
      });
    }
  });
})();
</script>




<script>
(function () {
  'use strict';

  var SEARCH_DATA_URL = '/assets/search-data.json';
  var searchState = {
    docs: null,
    promise: null,
    error: null,
  };
  var activeBindings = null;

  function ensureSearchData() {
    if (searchState.docs) {
      return Promise.resolve(searchState.docs);
    }
    if (searchState.promise) {
      return searchState.promise;
    }
    searchState.promise = fetch(SEARCH_DATA_URL, { credentials: 'same-origin' })
      .then(function (response) {
        if (!response.ok) {
          throw new Error('Search data request failed with status ' + response.status);
        }
        return response.json();
      })
      .then(function (raw) {
        if (!Array.isArray(raw)) {
          throw new Error('Search data is not an array.');
        }
        searchState.docs = raw.map(function (doc) {
          var title = (doc.title || '').toString();
          var excerpt = (doc.excerpt || '').toString();
          var content = (doc.content || '').toString();
          var enriched = {
            title: title,
            excerpt: excerpt,
            content: content,
            url: doc.url,
            collection: doc.collection,
            date: doc.date,
            tags: doc.tags,
          };
          enriched.titleLower = title.toLowerCase();
          enriched.excerptLower = excerpt.toLowerCase();
          enriched._text = (title + ' ' + excerpt + ' ' + content).toLowerCase();
          return enriched;
        });
        searchState.error = null;
        return searchState.docs;
      })
      .catch(function (error) {
        searchState.error = error;
        searchState.promise = null;
        throw error;
      });

    return searchState.promise;
  }

  function performSearch(query) {
    if (!searchState.docs) {
      return [];
    }
    var terms = query
      .trim()
      .toLowerCase()
      .split(/\s+/)
      .filter(Boolean);

    if (!terms.length) {
      return [];
    }

    var results = [];
    for (var i = 0; i < searchState.docs.length; i++) {
      var doc = searchState.docs[i];
      var score = 0;
      var missingTerm = false;
      for (var j = 0; j < terms.length; j++) {
        var term = terms[j];
        if (!doc._text.includes(term)) {
          missingTerm = true;
          break;
        }

        if (doc.titleLower.includes(term)) {
          score += 6;
        }
        if (doc.excerptLower && doc.excerptLower.includes(term)) {
          score += 3;
        }
        score += 1;
      }

      if (!missingTerm) {
        results.push({
          doc: doc,
          score: score,
          firstMatch: doc._text.indexOf(terms[0]),
        });
      }
    }

    results.sort(function (a, b) {
      if (b.score !== a.score) {
        return b.score - a.score;
      }
      return a.firstMatch - b.firstMatch;
    });

    var sliced = results.slice(0, 20);
    var mapped = [];
    for (var k = 0; k < sliced.length; k++) {
      mapped.push(sliced[k].doc);
    }
    return mapped;
  }

  function formatCollectionLabel(label) {
    if (!label || label === 'pages') {
      return '';
    }
    return label
      .toString()
      .replace(/[_-]+/g, ' ')
      .replace(/\b\w/g, function (letter) {
        return letter.toUpperCase();
      });
  }

  function detachBindings() {
    if (activeBindings && typeof activeBindings.destroy === 'function') {
      activeBindings.destroy();
    }
    activeBindings = null;
  }

  function bindSearchUI() {
    detachBindings();

    var toggle = document.querySelector('[data-search-toggle]');
    var panel = document.querySelector('[data-search-panel]');
    if (!toggle || !panel) {
      return;
    }

    var input = panel.querySelector('[data-search-input]');
    var closeButton = panel.querySelector('[data-search-close]');
    var resultsList = panel.querySelector('[data-search-results]');
    var statusEl = panel.querySelector('[data-search-status]');
    var emptyEl = panel.querySelector('[data-search-empty]');
    var queryLabel = emptyEl ? emptyEl.querySelector('[data-search-query]') : null;
    if (!input || !resultsList) {
      return;
    }

    var isOpen = false;
    var resizeListenerAttached = false;

    function positionPanel() {
      if (!isOpen) {
        return;
      }
      var surface = panel.querySelector('.nav-search-surface') || panel;
      if (!surface) {
        return;
      }

      var viewportWidth = Math.max(
        document.documentElement.clientWidth || 0,
        window.innerWidth || 0
      );
      var viewportHeight = Math.max(
        document.documentElement.clientHeight || 0,
        window.innerHeight || 0
      );
      var padding = 16;
      var surfaceWidth = surface.offsetWidth;
      var surfaceHeight = surface.offsetHeight;
      var toggleRect = toggle.getBoundingClientRect();

      var left = toggleRect.right - surfaceWidth;
      left = Math.max(padding, Math.min(left, viewportWidth - surfaceWidth - padding));

      var top = toggleRect.bottom + 12;
      top = Math.max(padding, Math.min(top, viewportHeight - surfaceHeight - padding));

      panel.style.left = left + 'px';
      panel.style.right = 'auto';
      panel.style.top = top + 'px';
    }

    function attachResizeListener() {
      if (resizeListenerAttached) {
        return;
      }
      window.addEventListener('resize', positionPanel);
      resizeListenerAttached = true;
    }

    function detachResizeListener() {
      if (!resizeListenerAttached) {
        return;
      }
      window.removeEventListener('resize', positionPanel);
      resizeListenerAttached = false;
    }

    function setStatus(message, show) {
      if (!statusEl) {
        return;
      }
      var text = message || '';
      statusEl.textContent = text;
      statusEl.hidden = !text || show === false;
      positionPanel();
    }

    function clearStatus() {
      setStatus('', false);
    }

    function showEmpty(query) {
      if (!emptyEl) {
        return;
      }
      if (queryLabel) {
        queryLabel.textContent = query ? '“' + query + '”' : '';
      }
      emptyEl.hidden = !query;
      positionPanel();
    }

    function hideEmpty() {
      if (emptyEl) {
        emptyEl.hidden = true;
      }
      if (queryLabel) {
        queryLabel.textContent = '';
      }
    }

    function clearResults() {
      resultsList.innerHTML = '';
      hideEmpty();
      clearStatus();
      positionPanel();
    }

    function renderResults(items, query) {
      resultsList.innerHTML = '';
      if (!items.length) {
        showEmpty(query);
        setStatus('No results for “' + query + '”.', true);
        positionPanel();
        return;
      }

      hideEmpty();
      var fragment = document.createDocumentFragment();
      for (var index = 0; index < items.length; index++) {
        var doc = items[index];
        var listItem = document.createElement('li');
        listItem.className = 'search-result';
        listItem.setAttribute('role', 'listitem');

        var link = document.createElement('a');
        link.className = 'search-result__link';
        link.href = doc.url;
        link.textContent = doc.title || doc.url || 'Untitled';
        listItem.appendChild(link);

        var metaParts = [];
        var collectionLabel = formatCollectionLabel(doc.collection);
        if (collectionLabel) {
          metaParts.push(collectionLabel);
        }
        if (doc.date) {
          var date = new Date(doc.date);
          if (!isNaN(date.getTime())) {
            metaParts.push(
              date.toLocaleDateString(undefined, {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
              })
            );
          }
        }

        if (metaParts.length) {
          var meta = document.createElement('span');
          meta.className = 'search-result__meta';
          meta.textContent = metaParts.join(' • ');
          listItem.appendChild(meta);
        }

        if (doc.excerpt) {
          var excerpt = document.createElement('p');
          excerpt.className = 'search-result__excerpt';
          excerpt.textContent = doc.excerpt;
          listItem.appendChild(excerpt);
        }

        fragment.appendChild(listItem);
      }

      resultsList.appendChild(fragment);
      setStatus(
        'Showing ' + items.length + ' result' + (items.length === 1 ? '' : 's') + '.',
        true
      );
      positionPanel();
    }

    function handleQueryChange() {
      var query = input.value.trim();
      if (!query) {
        clearResults();
        setStatus('Start typing to search.', true);
        return;
      }

      ensureSearchData()
        .then(function () {
          var matches = performSearch(query);
          renderResults(matches, query);
        })
        .catch(function () {
          setStatus('Search is temporarily unavailable. Please try again later.', true);
        });
    }

    function handleEscape(event) {
      if (event.key === 'Escape') {
        event.preventDefault();
        closePanel({ focusToggle: true });
      }
    }

    function handleDocumentClick(event) {
      if (!isOpen) {
        return;
      }
      if (
        !panel.contains(event.target) &&
        event.target !== toggle &&
        !toggle.contains(event.target)
      ) {
        closePanel({ focusToggle: false });
      }
    }

    function openPanel() {
      if (isOpen) {
        return;
      }
      isOpen = true;
      panel.removeAttribute('hidden');
      panel.style.left = '';
      panel.style.right = '';
      panel.style.top = '';
      toggle.setAttribute('aria-expanded', 'true');

      if (!input.value.trim()) {
        setStatus('Start typing to search.', true);
      }

      if (!searchState.docs && !searchState.promise) {
        setStatus('Loading search index…', true);
      }

      ensureSearchData()
        .then(function () {
          if (input.value.trim()) {
            handleQueryChange();
          } else {
            setStatus('Start typing to search.', true);
          }
        })
        .catch(function () {
          setStatus('Search is temporarily unavailable. Please try again later.', true);
        });

      positionPanel();
      attachResizeListener();
      requestAnimationFrame(function () {
        positionPanel();
        input.focus({ preventScroll: true });
      });

      document.addEventListener('keydown', handleEscape, true);
      document.addEventListener('mousedown', handleDocumentClick, true);
    }

    function closePanel(options) {
      if (!isOpen) {
        return;
      }
      var opts = options || {};
      isOpen = false;
      panel.setAttribute('hidden', '');
      toggle.setAttribute('aria-expanded', 'false');
      document.removeEventListener('keydown', handleEscape, true);
      document.removeEventListener('mousedown', handleDocumentClick, true);
      detachResizeListener();
      panel.style.left = '';
      panel.style.right = '';
      panel.style.top = '';

      if (opts.resetQuery) {
        input.value = '';
        clearResults();
      }

      if (opts.focusToggle !== false) {
        toggle.focus();
      }
    }

    function destroy() {
      document.removeEventListener('keydown', handleEscape, true);
      document.removeEventListener('mousedown', handleDocumentClick, true);
      detachResizeListener();
      toggle.removeEventListener('click', onToggle);
      input.removeEventListener('input', handleQueryChange);
      input.removeEventListener('keydown', handleInputEnter);
      if (closeButton) {
        closeButton.removeEventListener('click', onClose);
      }
      resultsList.removeEventListener('click', onResultClick);
      closePanel({ focusToggle: false });
    }

    function onToggle(event) {
      event.preventDefault();
      if (isOpen) {
        closePanel({ focusToggle: false });
      } else {
        openPanel();
      }
    }

    function onClose(event) {
      event.preventDefault();
      closePanel({ focusToggle: true });
    }

    function handleInputEnter(event) {
      if (event.key === 'Enter') {
        var firstLink = resultsList.querySelector('a');
        if (firstLink) {
          event.preventDefault();
          firstLink.click();
        }
      }
    }

    function onResultClick(event) {
      var anchor = event.target.closest('a');
      if (!anchor) {
        return;
      }
      closePanel({ focusToggle: false });
    }

    toggle.addEventListener('click', onToggle);
    input.addEventListener('input', handleQueryChange);
    input.addEventListener('keydown', handleInputEnter);
    if (closeButton) {
      closeButton.addEventListener('click', onClose);
    }
    resultsList.addEventListener('click', onResultClick);

    activeBindings = {
      destroy: destroy,
      close: closePanel,
    };
  }

  var pushState = document.getElementById('_pushState');
  if (pushState) {
    pushState.addEventListener('hy-push-state-after', function () {
      bindSearchUI();
    });
    pushState.addEventListener('hy-push-state-start', function () {
      if (activeBindings && typeof activeBindings.close === 'function') {
        activeBindings.close({ focusToggle: false, resetQuery: false });
      }
    });
  }

  bindSearchUI();
})();
</script>



<div hidden>
  
  <h2 class="sr-only">Templates (for web app):</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loading…</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Error</h1>
    
    
    <p class="lead">
      Sorry, an error occurred while loading <a class="this-link" href=""></a>.

    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover" >
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
</div>


</body>
</html>
